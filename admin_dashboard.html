<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>ISSO Staff Dashboard - UbianWorld</title>
        <link rel="stylesheet" href="styles.css">
        <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
        <script src="script.js" defer></script>
    </head>

    <body class="admin-body">
        <header>
            <div class="brand-container">
                <img src="logo.jpg" alt="ISSO Logo" class="header-logo">
                <span class="brand-text">ISSO Staff</span>
            </div>

            <!-- Removed hardcoded navigation - will be generated by script.js based on role -->
            <nav>
                <ul>
                    <!-- Navigation will be dynamically generated -->
                </ul>
            </nav>
        </header>

        <main class="container admin-main">
            <h1>ISSO Staff Dashboard</h1>
            <p>Welcome to the International Student Services Office administrative panel. Manage student inquiries, content, and reports from here.</p>

            <div id="admin-dashboard-content">
                
                <!-- STAFF INFO SECTION (UPDATED FOR EDITING) -->
                <section class="staff-info-section dashboard-section">
                    <div class="section-header" style="justify-content: flex-start; gap: 15px;">
                        <h2>My Staff Information</h2>
                        <!-- The Toggle Button -->
                        <button class="edit-btn" style="font-size: 1.2rem; display: inline-block;" onclick="toggleEdit(this, 'staff-profile')">‚úé</button>
                    </div>
                    
                    <div class="profile-details staff-details">
                        <!-- ID is NOT editable -->
                        <p><strong>Staff ID:</strong> <span id="staff-id">ISSO-001</span></p>
                        
                        <!-- These fields ARE editable -->
                        <p><strong>Name:</strong> <span id="staff-name" class="editable-text">Jane Doe</span></p>
                        <p><strong>Department:</strong> <span id="staff-department" class="editable-text">ISSO - Operations</span></p>
                        <p><strong>Contact Ext:</strong> <span id="staff-ext" class="editable-text">105</span></p>
                    </div>
                </section>

                <hr style="margin: 30px 0;">

                <section class="dashboard-section inquiry-management">
                    <div class="section-header">
                        <h2>‚úâÔ∏è Student Inquiries & Support Tickets</h2>
                        <button class="cta-button primary-cta" id="refresh-inquiries">Refresh List</button>
                    </div>

                    <div class="inquiry-status-summary">
                        <p id="inquiry-summary">Loading summary...</p>
                    </div>

                    <div class="inquiry-list-wrapper">
                        <table class="data-table inquiry-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Student (Username)</th>
                                    <th>Subject</th>
                                    <th>Submitted On</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="inquiry-list-table-body">
                                <tr>
                                    <td colspan="6" style="text-align: center; padding: 30px;">
                                        <p>Fetching student inquiries...</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>
                
                <hr style="margin: 50px 0;">

                <!-- Added Contact Messages section for admin to view and respond to contact form submissions -->
                <section class="dashboard-section contact-messages-management">
                    <div class="section-header">
                        <h2>üì¨ Contact Form Messages</h2>
                        <button class="cta-button primary-cta" id="refresh-contact-messages">Refresh List</button>
                    </div>

                    <div class="contact-messages-summary">
                        <p id="contact-messages-summary">Loading summary...</p>
                    </div>

                    <div class="contact-messages-wrapper">
                        <table class="data-table contact-messages-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Subject</th>
                                    <th>Submitted On</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="contact-messages-table-body">
                                <tr>
                                    <td colspan="7" style="text-align: center; padding: 30px;">
                                        <p>Fetching contact messages...</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <hr style="margin: 50px 0;">

                <!-- Added Document Management section for admins to review and approve/reject student documents -->
                <section class="dashboard-section document-management">
                    <div class="section-header">
                        <h2>üìÑ Document Management</h2>
                        <button class="cta-button primary-cta" id="refresh-documents">Refresh List</button>
                    </div>

                    <div class="documents-summary">
                        <p id="documents-summary">Loading summary...</p>
                    </div>

                    <div class="documents-wrapper">
                        <table class="data-table documents-table">
                            <thead>
                                <tr>
                                    <th>Doc ID</th>
                                    <th>Student Name</th>
                                    <th>Document Type</th>
                                    <th>File Type</th>
                                    <th>Upload Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="documents-table-body">
                                <tr>
                                    <td colspan="7" style="text-align: center; padding: 30px;">
                                        <p>Fetching student documents...</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <hr style="margin: 50px 0;">

                <section class="dashboard-section content-management">
                    <h2>üìù Content Management</h2>
                    <div class="admin-grid-links">
                        <a href="announcement.html" class="admin-card primary-card">
                            <h3>Manage Announcements</h3>
                            <p>Create, edit, or delete news and events.</p>
                        </a>
                        <a href="guides.html" class="admin-card secondary-card">
                            <h3>Manage Guides & Forms</h3>
                            <p>Upload new documents and policy guides.</p>
                        </a>
                        <a href="support.html" class="admin-card tertiary-card">
                            <h3>Manage FAQs</h3>
                            <p>Add and modify frequently asked questions.</p>
                        </a>
                    </div>
                </section>
                
                <hr style="margin: 50px 0;">
                
            </div>
            
            <div id="admin-access-denied" style="display: none; text-align: center; padding: 50px; border: 1px solid #ddd; background: #fff; margin-top: 50px;">
                <h2>Access Denied üõë</h2>
                <p>You must be logged in as an ISSO Staff member to view this page.</p>
                <a href="login.html" class="cta-button" style="margin-top: 20px;">Go to Login</a>
            </div>

        </main>

        <footer>
            <div class="container footer-content">
                <div class="footer-col">
                    <h3>About UbianWorld</h3>
                    <p>Your go-to platform for university support...</p>
                </div>
                <div class="footer-col">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="announcement.html">Announcements</a></li>
                        <li><a href="guides.html">Guides & Forms</a></li>
                        <li><a href="support.html">Support</a></li>
                        <li><a href="contact.html">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h3>Contact Us</h3>
                    <p>Email: info@ubianworld.edu.ph</p>
                    <p>Phone: +63 123 456 7890</p>
                    <p>Address: University of Batangas, Batangas City, Philippines</p>
                </div>
            </div>
        </footer>

        <!-- Added inquiry detail modal for admin to view and respond to student inquiries -->
        <div id="inquiry-detail-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Student Inquiry Details</h2>
                    <button type="button" class="close-modal-btn" onclick="closeInquiryModal()">&times;</button>
                </div>
                
                <div class="modal-body">
                    <div class="inquiry-details-view">
                        <div class="inquiry-info-grid">
                            <div class="info-row">
                                <strong>Inquiry ID:</strong>
                                <span id="modal-inquiry-id">-</span>
                            </div>
                            <div class="info-row">
                                <strong>Student:</strong>
                                <span id="modal-student-name">-</span>
                            </div>
                            <div class="info-row">
                                <strong>Email:</strong>
                                <span id="modal-student-email">-</span>
                            </div>
                            <div class="info-row">
                                <strong>Submitted:</strong>
                                <span id="modal-submitted-date">-</span>
                            </div>
                            <div class="info-row">
                                <strong>Status:</strong>
                                <span id="modal-status" class="status-badge">-</span>
                            </div>
                        </div>
                        
                        <hr>
                        
                        <div class="inquiry-subject-description">
                            <h3>Subject</h3>
                            <p id="modal-subject">-</p>
                            
                            <h3>Description</h3>
                            <p id="modal-description" style="white-space: pre-wrap;">-</p>
                        </div>
                        
                        <hr>
                        
                        <div class="inquiry-response-section">
                            <h3>Admin Response</h3>
                            <div id="existing-response-view" style="display: none; background: #f0f8ff; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                                <strong>Previous Response:</strong>
                                <p id="existing-response-text" style="margin-top: 10px; white-space: pre-wrap;"></p>
                            </div>
                            
                            <form id="inquiry-response-form">
                                <input type="hidden" id="response-inquiry-id" name="inquiry_id">
                                
                                <label for="response-status">Update Status:</label>
                                <select id="response-status" name="status" required>
                                    <option value="pending">Pending</option>
                                    <option value="in_progress">In Progress</option>
                                    <option value="resolved">Resolved</option>
                                    <option value="closed">Rejected</option>
                                </select>
                                
                                <label for="response-text">Response Message:</label>
                                <textarea id="response-text" name="response" rows="6" placeholder="Type your response to the student here..."></textarea>
                                
                                <div style="display: flex; gap: 10px; margin-top: 15px;">
                                    <button type="submit" class="cta-button primary-cta">Submit Response</button>
                                    <button type="button" class="cta-button secondary-cta" onclick="closeInquiryModal()">Cancel</button>
                                </div>
                            </form>
                            
                            <div id="response-message" style="margin-top: 15px;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Added document review modal for admins to approve/reject documents -->
        <div id="document-review-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Review Student Document</h2>
                    <button type="button" class="close-modal-btn" onclick="closeDocumentModal()">&times;</button>
                </div>
                
                <div class="modal-body">
                    <div class="document-details-view">
                        <div class="document-info-grid">
                            <div class="info-row">
                                <strong>Document ID:</strong>
                                <span id="modal-document-id">-</span>
                            </div>
                            <div class="info-row">
                                <strong>Student Name:</strong>
                                <span id="modal-doc-student-name">-</span>
                            </div>
                            <div class="info-row">
                                <strong>Student ID:</strong>
                                <span id="modal-doc-student-id">-</span>
                            </div>
                            <div class="info-row">
                                <strong>Document Type:</strong>
                                <span id="modal-doc-type">-</span>
                            </div>
                            <div class="info-row">
                                <strong>File Type:</strong>
                                <span id="modal-doc-file-type">-</span>
                            </div>
                            <div class="info-row">
                                <strong>Upload Date:</strong>
                                <span id="modal-doc-upload-date">-</span>
                            </div>
                            <div class="info-row">
                                <strong>Current Status:</strong>
                                <span id="modal-doc-status" class="status-badge">-</span>
                            </div>
                            <div class="info-row">
                                <strong>File Path:</strong>
                                <span id="modal-doc-file-path">-</span>
                            </div>
                        </div>
                        
                        <hr>
                        
                        <div class="document-preview-section">
                            <h3>Document Preview</h3>
                            <div id="document-preview-container" style="border: 1px solid #ddd; padding: 10px; min-height: 200px; background: #f9f9f9; text-align: center;">
                                <p>Preview will appear here</p>
                            </div>
                        </div>
                        
                        <hr>
                        
                        <div class="document-review-section">
                            <h3>Review & Update Status</h3>
                            <div id="existing-review-view" style="display: none; background: #fff3cd; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                                <strong>Previous Review Notes:</strong>
                                <p id="existing-review-text" style="margin-top: 10px; white-space: pre-wrap;"></p>
                            </div>
                            
                            <form id="document-review-form">
                                <input type="hidden" id="review-document-id" name="document_id">
                                
                                <label for="review-status">Update Status:</label>
                                <select id="review-status" name="review_status" required>
                                    <option value="Pending">Pending</option>
                                    <option value="Under Review">Under Review</option>
                                    <option value="Approved">Approved</option>
                                    <option value="Rejected">Rejected</option>
                                </select>
                                
                                <label for="review-notes">Review Notes:</label>
                                <textarea id="review-notes" name="review_notes" rows="4" placeholder="Add notes about your review decision..."></textarea>
                                
                                <div style="display: flex; gap: 10px; margin-top: 15px;">
                                    <button type="submit" class="cta-button primary-cta">Submit Review</button>
                                    <button type="button" class="cta-button secondary-cta" onclick="closeDocumentModal()">Cancel</button>
                                </div>
                            </form>
                            
                            <div id="review-message" style="margin-top: 15px;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>
